{"version":3,"sources":["boomsvgloader.js","app.js"],"names":["root","factory","define","amd","exports","module","boomsvgloader","this","load","url","ajax","XMLHttpRequest","open","send","onload","e","div","document","createElement","style","cssText","innerHTML","responseText","body","insertBefore","childNodes","api_version","api_domain","location","hostname","includes","get_url","post_url","response_json","mainElement","querySelector","responseForm","textInput","helpButton","helpText","Alert","[object Object]","message","type","duration","constructor","make_alert","Promise","resolve","oldAlertId","getAttribute","replace","remove_alert","alertEl","create_alert_element","alertTimeoutId","window","setTimeout","setAttribute","addEventListener","classList","add","cursor","textEl","textContent","appendChild","insertAdjacentElement","timeout","instant","clearTimeout","getElementById","remove","ScottIs","responses","response_container","response_container_element","r","Object","prototype","hasOwnProperty","call","response_html","insertAdjacentHTML","word_cloud","min","max","low","Math","ceil","high","floor","random","el","mod","getRandomIntInclusive","serialize","form","URLSearchParams","FormData","toString","event","preventDefault","value","length","data","send_response","reset","limit","req_url","httpRequest","JSON","parse","layout","onreadystatechange","after_response","setRequestHeader","readyState","DONE","status","load_responses","console","error","toggle","hash","handle_form","help_setup","help_button"],"mappings":";CACA,SAAAA,EAAAC,GACA,mBAAAC,QAAAA,OAAAC,IAEAD,OAAA,CAAA,iBAAAD,GACA,iBAAAG,QAEAC,OAAAD,QAAAH,IAGAD,EAAAM,cAAAL,IATA,CAWAM,MAAA,WACA,aAYA,MAAA,CACAC,KAZA,SAAAC,GACA,IAAAC,EAAA,IAAAC,eACAD,EAAAE,KAAA,MAAAH,GAAA,GACAC,EAAAG,OACAH,EAAAI,OAAA,SAAAC,GACA,IAAAC,EAAAC,SAAAC,cAAA,OACAF,EAAAG,MAAAC,QAAA,yGACAJ,EAAAK,UAAAX,EAAAY,aACAL,SAAAM,KAAAC,aAAAR,EAAAC,SAAAM,KAAAE,WAAA,UAjBA,MAAAC,YAAA,MACA,IAAAC,WAGAA,WADAC,SAAAC,SAAAC,SAAA,OACA,wBAEA,oBAGA,MAAAC,QAAA,WAAAJ,4BACAK,SAAA,WAAAL,4BACA,IAAAM,cAGA,MAAAC,YAAAjB,SAAAkB,cAAA,QACAC,aAAAnB,SAAAkB,cAAA,eACAE,UAAApB,SAAAkB,cAAA,kCACAG,WAAArB,SAAAkB,cAAA,gBACAI,SAAAtB,SAAAkB,cAAA,cAGA,MAAAK,MACAC,YAAAC,EAAAC,EAAA,UAAAC,EAAA,KACArC,KAAAsC,YAAAC,WAAAJ,EAAAC,EAAAC,GC1BAH,kBAAAC,EAAAC,EAAA,UAAAC,EAAA,KACA,OAAA,IAAAG,QAAAC,IAEA,GAAA/B,SAAAkB,cAAA,gBAAA,CACA,MACAc,EADAhC,SAAAkB,cAAA,gBACAe,aAAA,MAAAC,QAAA,SAAA,IACA5C,KAAA6C,aAAAH,GAAA,GAIA,MAAAI,EAAA9C,KAAA+C,qBAAAZ,EAAAC,GAGAY,EAAAC,OAAAC,WAAA,KACAlD,KAAA6C,aAAAG,GACAP,KACAJ,GAGAS,EAAAK,aAAA,KAAA,SAAAH,KAGAF,EAAAM,iBAAA,QAAA,KACApD,KAAA6C,aAAAG,GACAP,MACA,KAIAP,4BAAAC,EAAAC,GACA,MAAAU,EAAApC,SAAAC,cAAA,OACAmC,EAAAK,aAAA,OAAA,SACAL,EAAAK,aAAA,YAAA,aACAL,EAAAO,UAAAC,IAAA,QAAAlB,GACAU,EAAAlC,MAAA2C,OAAA,UACA,MAAAC,EAAA9C,SAAAC,cAAA,KAKA,OAJA6C,EAAAC,YAAAtB,EACAW,EAAAY,YAAAF,GACA3B,aAAA8B,sBAAA,WAAAb,GAEAA,EAGAZ,oBAAA0B,EAAAC,GAAA,GACAZ,OAAAa,aAAAF,GACA,MAAAd,EAAApC,SAAAqD,eAAA,SAAAH,KAEAd,IAAA,IAAAe,IACAf,EAAAO,UAAAC,IAAA,UAEAJ,WAAA,KACAJ,EAAAkB,UACA,MAGAlB,IAAA,IAAAe,GACAf,EAAAkB,UAMA,MAAAC,QAAA,CAEA/B,OAAAgC,GAEA,IAAAC,EAAAzD,SAAAkB,cAAA,cACAuC,GACAA,EAAAH,SAEA,MAAAI,EAAA1D,SAAAC,cAAA,MACAyD,EAAAf,UAAAC,IAAA,aACA3B,YAAAgC,sBAAA,YAAAS,GAEAD,EAAAzD,SAAAkB,cAAA,cAGA,IAAA,IAAAyC,KAAAH,EACA,GAAAI,OAAAC,UAAAC,eAAAC,KAAAP,EAAAG,GAAA,CAEA,MAAAK,EAAA,4BAAAL,MAAAH,EAAAG,UACAF,EAAAQ,mBAAA,aAAAD,GACA1E,KAAA4E,WAAAlE,SAAAqD,eAAAM,MAKAnC,sBAAA2C,EAAAC,GACA,MAAAC,EAAAC,KAAAC,KAAAJ,GACAK,EAAAF,KAAAG,MAAAL,GACA,OAAAE,KAAAG,MAAAH,KAAAI,UAAAF,EAAAH,EAAA,IAAAA,GAGA7C,WAAAmD,GACA,MAAAC,EAAAtF,KAAAuF,sBAAA,EAAA,GACAF,EAAAhC,UAAAC,IAAA,QAAAgC,MAGAE,UAAAC,GAEA,IAAAC,gBAAA,IAAAC,SAAAF,IAAAG,WAOA1D,YAAA2D,GAEA,GADAA,EAAAC,iBACAhE,UAAAiE,MAAAC,OAAA,GAEA,OADA/D,MAAAM,WAAA,2CAAA,YACA,EAEA,GAAA,GAAAT,UAAAiE,MAAAC,OAEA,OADA/D,MAAAM,WAAA,kDAAA,YACA,EAGA,MAAA0D,EAAAhC,QAAAuB,UAAA3D,cAEAoC,QAAAiC,cAAAzE,SAAAwE,GACApE,aAAAsE,SAGAjE,eAAAhC,EAAAkG,EAAA,KACA,MAAAC,EAAA,GAAAnG,WAAAkG,IACAE,EAAA,IAAAlG,eACAkG,EAAAjG,KAAA,MAAAgG,GAAA,GACAC,EAAAhG,OACAgG,EAAA/F,OAAA,KACAmB,cAAA6E,KAAAC,MAAAF,EAAAvF,cACAf,KAAAyG,OAAA/E,iBAIAQ,cAAAhC,EAAA+F,GACA,MAAAK,EAAA,IAAAlG,eACAkG,EAAAjG,KAAA,OAAAH,GAAA,GACAoG,EAAAI,mBAAA,KACA1G,KAAA2G,eAAAL,IAEAA,EAAAM,iBAAA,eAAA,oDACAN,EAAAhG,KAAA2F,IAGA/D,eAAAoE,GACAA,EAAAO,aAAAzG,eAAA0G,OACA,MAAAR,EAAAS,QACA9E,MAAAM,WAAA,8BAAA,WACAvC,KAAAgH,eAAAxF,UACA,MAAA8E,EAAAS,OACA9E,MAAAM,WAAA,yEAAA,YAEAN,MAAAM,WAAA,yCAAA,WACA0E,QAAAC,MAAA,4CAKAhF,YAAA2D,GACAA,EAAAC,iBACA/D,WAAAsB,UAAA8D,OAAA,WACAnF,SAAAqB,UAAA8D,OAAA,UACAnF,SAAAqB,UAAA8D,OAAA,YAGAjF,aACA,SAAAe,OAAA5B,SAAA+F,OACArF,WAAAsB,UAAA8D,OAAA,WACAnF,SAAAqB,UAAAW,OAAA,aAMA,IACAjE,cAAAE,KAAA,wCACA,MAAAiH,GACAD,QAAAC,MAAAA,GAGAjD,QAAA+C,eAAAxF,SACAK,aAAAuB,iBAAA,SAAAa,QAAAoD,aACApD,QAAAqD,aACAvF,WAAAqB,iBAAA,QAAAa,QAAAsD","file":"app.js","sourcesContent":["/*! BoomSVGLoader 0.0.1 | http://boomtownroi.github.io/boomsvgloader/ | (c) 2015 BoomTown | MIT License */\n(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD\n    define(['boomsvgloader'], factory);\n  } else if (typeof exports === 'object') {\n    // Node, CommonJS-like\n    module.exports = factory();\n  } else {\n    // Browser globals (root is window)\n    root.boomsvgloader = factory();\n  }\n}(this, function() {\n  'use strict';\n  function load(url) {\n    var ajax = new XMLHttpRequest();\n    ajax.open(\"GET\", url, true);\n    ajax.send();\n    ajax.onload = function(e) {\n      var div = document.createElement(\"div\");\n      div.style.cssText = 'border: 0; clip: rect(0 0 0 0); height: 0; overflow: hidden; padding: 0; position: absolute; width: 0;';\n      div.innerHTML = ajax.responseText;\n      document.body.insertBefore(div, document.body.childNodes[0]);\n    };\n  }\n  return {\n    load: load\n  };\n}));","'use strict';\n\n/* Global Variables */\n/* global boomsvgloader:false */\n\nconst api_version = '1.4';\nlet api_domain;\n\nif ( location.hostname.includes( 'dev' ) ) {\n\tapi_domain = 'dev-api.scottsmith.is';\n} else {\n\tapi_domain = 'api.scottsmith.is';\n}\n\nconst get_url = `https://${ api_domain }/v${ api_version }/responses`;\nconst post_url = `https://${ api_domain }/v${ api_version }/responses`;\nlet response_json;\n\n/* Page Elements */\nconst mainElement = document.querySelector( 'main' );\nconst responseForm = document.querySelector( '.input-form' );\nconst textInput = document.querySelector( '.input-form input[type=\"text\"]' );\nconst helpButton = document.querySelector( 'header .help' );\nconst helpText = document.querySelector( '.help-text' );\n\n/* Alerts Module */\nclass Alert {\n\tconstructor( message, type = 'neutral', duration = 4000 ) {\n\t\tthis.constructor.make_alert( message, type, duration );\n\t}\n\n\tstatic make_alert( message, type = 'neutral', duration = 4000 ) {\n\t\treturn new Promise( resolve => {\n\t\t\t// Check for and remove any preexisting alerts.\n\t\t\tif ( document.querySelector( '[role=alert]' ) ) {\n\t\t\t\tconst oldAlert = document.querySelector( '[role=alert]' );\n\t\t\t\tconst oldAlertId = oldAlert.getAttribute( 'id' ).replace( 'alert-', '' );\n\t\t\t\tthis.remove_alert( oldAlertId, true );\n\t\t\t}\n\n\t\t\t// Create alert element.\n\t\t\tconst alertEl = this.create_alert_element( message, type );\n\n\t\t\t// Remove alert after duration.\n\t\t\tconst alertTimeoutId = window.setTimeout( () => {\n\t\t\t\tthis.remove_alert( alertTimeoutId );\n\t\t\t\tresolve();\n\t\t\t}, duration );\n\n\t\t\t// Save alert ID (timeout ID counter) as element id.\n\t\t\talertEl.setAttribute( 'id', `alert-${ alertTimeoutId }` );\n\n\t\t\t// Allow user to dismiss alert by clicking.\n\t\t\talertEl.addEventListener( 'click', () => {\n\t\t\t\tthis.remove_alert( alertTimeoutId );\n\t\t\t\tresolve();\n\t\t\t}, false );\n\t\t} );\n\t}\n\n\tstatic create_alert_element( message, type ) {\n\t\tconst alertEl = document.createElement( 'div' );\n\t\talertEl.setAttribute( 'role', 'alert' );\n\t\talertEl.setAttribute( 'aria-live', 'assertive' );\n\t\talertEl.classList.add( 'alert', type );\n\t\talertEl.style.cursor = 'pointer';\n\t\tconst textEl = document.createElement( 'p' );\n\t\ttextEl.textContent = message;\n\t\talertEl.appendChild( textEl );\n\t\tresponseForm.insertAdjacentElement( 'afterend', alertEl );\n\n\t\treturn alertEl;\n\t}\n\n\tstatic remove_alert( timeout, instant = false ) {\n\t\twindow.clearTimeout( timeout );\n\t\tconst alertEl = document.getElementById( `alert-${ timeout }` );\n\n\t\tif ( alertEl && instant === false ) {\n\t\t\talertEl.classList.add( 'remove' );\n\n\t\t\tsetTimeout( () => {\n\t\t\t\talertEl.remove();\n\t\t\t}, 1000 );\n\t\t}\n\n\t\tif ( alertEl && instant === true ) {\n\t\t\talertEl.remove();\n\t\t}\n\t}\n}\n\n/* Client Module */\nconst ScottIs = {\n\n\tlayout( responses ) {\n\t\t// Add Response container to DOM.\n\t\tlet response_container = document.querySelector( '.responses' );\n\t\tif ( response_container ) {\n\t\t\tresponse_container.remove();\n\t\t}\n\t\tconst response_container_element = document.createElement( 'ul' );\n\t\tresponse_container_element.classList.add( 'responses' );\n\t\tmainElement.insertAdjacentElement( 'beforeend', response_container_element );\n\t\t// Redefine element after removal.\n\t\tresponse_container = document.querySelector( '.responses' );\n\n\t\t// Position each response with a random position.\n\t\tfor ( let r in responses ) {\n\t\t\tif ( Object.prototype.hasOwnProperty.call( responses, r ) ) {\n\t\t\t\t// Add content divs\n\t\t\t\tconst response_html = `<li class=\"response\" id=\"${ r }\">${ responses[ r ] }</li>`;\n\t\t\t\tresponse_container.insertAdjacentHTML( 'afterbegin', response_html );\n\t\t\t\tthis.word_cloud( document.getElementById( r ) );\n\t\t\t}\n\t\t}\n\t},\n\n\tgetRandomIntInclusive( min, max ) {\n\t\tconst low = Math.ceil( min );\n\t\tconst high = Math.floor( max );\n\t\treturn Math.floor( Math.random() * ( high - low + 1 ) ) + low;\n\t},\n\n\tword_cloud( el ) {\n\t\tconst mod = this.getRandomIntInclusive( 1, 4 );\n\t\tel.classList.add( `size-${ mod }` );\n\t},\n\n\tserialize( form ) {\n\t\t// Source: https://stackoverflow.com/a/44033425/1867887\n\t\treturn new URLSearchParams( new FormData( form ) ).toString();\n\t},\n\n\t/*\n\t *  This function is called with the event scope and thus needs to reference\n\t *  other functions in the object as 'ScottIs.func()' instead of 'this.func()'.\n\t */\n\thandle_form( event ) {\n\t\tevent.preventDefault();\n\t\tif ( textInput.value.length > 20 ) {\n\t\t\tAlert.make_alert( 'Try to keep responses under 20 chars. 😅', 'failure' );\n\t\t\treturn false;\n\t\t}\n\t\tif ( textInput.value.length == 0 ) {\n\t\t\tAlert.make_alert( \"You've gotta actually have something to say. 😒\", 'failure' );\n\t\t\treturn false;\n\t\t}\n\n\t\tconst data = ScottIs.serialize( responseForm );\n\n\t\tScottIs.send_response( post_url, data );\n\t\tresponseForm.reset();\n\t},\n\n\tload_responses( url, limit = 100 ) {\n\t\tconst req_url = `${ url }?limit=${ limit }`;\n\t\tconst httpRequest = new XMLHttpRequest();\n\t\thttpRequest.open( 'GET', req_url, true );\n\t\thttpRequest.send();\n\t\thttpRequest.onload = () => {\n\t\t\tresponse_json = JSON.parse( httpRequest.responseText );\n\t\t\tthis.layout( response_json );\n\t\t};\n\t},\n\n\tsend_response( url, data ) {\n\t\tconst httpRequest = new XMLHttpRequest();\n\t\thttpRequest.open( 'POST', url, true );\n\t\thttpRequest.onreadystatechange = () => {\n\t\t\tthis.after_response( httpRequest );\n\t\t};\n\t\thttpRequest.setRequestHeader( 'Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8' );\n\t\thttpRequest.send( data );\n\t},\n\n\tafter_response( httpRequest ) {\n\t\tif ( httpRequest.readyState === XMLHttpRequest.DONE ) {\n\t\t\tif ( httpRequest.status === 200 ) {\n\t\t\t\tAlert.make_alert( 'Success! Message posted. 👍', 'success' );\n\t\t\t\tthis.load_responses( get_url );\n\t\t\t} else if ( httpRequest.status === 202 ) {\n\t\t\t\tAlert.make_alert( 'Uh oh! That is a duplicate response. Try coming up with something new!', 'failure' );\n\t\t\t} else {\n\t\t\t\tAlert.make_alert( 'Uh small problem. Tell me about it. 😕', 'failure' );\n\t\t\t\tconsole.error( 'There was a problem with the request.' );\n\t\t\t}\n\t\t}\n\t},\n\n\thelp_button( event ) {\n\t\tevent.preventDefault();\n\t\thelpButton.classList.toggle( 'visible' );\n\t\thelpText.classList.toggle( 'hidden' );\n\t\thelpText.classList.toggle( 'visible' );\n\t},\n\n\thelp_setup() {\n\t\tif ( window.location.hash == '#help' ) {\n\t\t\thelpButton.classList.toggle( 'visible' );\n\t\t\thelpText.classList.remove( 'hidden' );\n\t\t}\n\t}\n};\n\n/* Client Actions */\ntry {\n\tboomsvgloader.load( '/assets/images/icons/icon-sprite.svg' );\n} catch ( error ) {\n\tconsole.error( error );\n}\n\nScottIs.load_responses( get_url );\nresponseForm.addEventListener( 'submit', ScottIs.handle_form );\nScottIs.help_setup();\nhelpButton.addEventListener( 'click', ScottIs.help_button );\n"]}